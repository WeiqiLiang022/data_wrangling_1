code for Lecture 9.17
